<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ghibli</title>
  <link href="./css/reset.css" rel="stylesheet">
  <link href="./css/event.css" rel="stylesheet">
</head>
<body>
  <div id="container" class="flex flex-direction-column absolute">
    <!-- ***랜턴이미지*** -->
    <div id="lantern" class="absolute"></div>




    <!-- ***배경*** -->
    <div id="bg" class="absolute"></div>
    


    
    <!-- ***헤더영역*** -->
    <div id="header-wrap" class="flex space-between">
      <header class="flex relative">
        <div id="left" class="flex align-items-center">
          <div id="hamburger">
            <a href="#" class="block">
              <img src="./img/icon/hamburger.png" alt="menu">
            </a>
          </div>
        </div>
        <div id="logo">
          <a href="./index.html">
            <img src="./img/logo/ghibli_logo.png" alt="logo">
          </a>
        </div>
      </header>
    </div> 
    <!-- 메뉴(메뉴 버튼 클릭시 나옴) -->
    <div id="menu" class="absolute">
      <ul>
        <li>
          <a href="#">
            <span>NEWS</span>
          </a>
        </li>
        <li>
          <a href="./event.html">
            <span>EVENT</span>
          </a>
        </li>
        <li>
          <a href="#">
            <span>BOOK</span>
          </a>
        </li>
        <li>
          <a href="./film.html">
            <span>FILM</span>
          </a>
        </li>
        <li>
          <a href="#">
            <span>ABOUT</span>
          </a>
        </li>
        <li>
          <a href="#">
            <span>HELP</span>
          </a>
        </li>
      </ul>
    </div>
    <!-- 푸터(메뉴 버튼 클릭시 나옴) -->
    <footer id="footer" class="absolute">
      <span>&copy; 2005-2022 STUDIO GHIBLI Inc</span>
      <span>·</span>
      <a href="#">Terms of use</a>
      <span>·</span>
      <a href="#">Contact</a>
      <span>·</span>
      <a href="#">Rss feed</a>
    </footer>
    




    <!-- ***사이드메뉴*** -->
    <section id="side-menu" class="relative">
      <h2 class="none">side-menu</h2>
      <ul id="side-menu-ul" class="list-style-none">
        <li data-index="0">
          <a href="#" class="block">ONGOING</a>
        </li>
        <li data-index="1">
          <a href="#" class="block">CLOSED</a>
        </li>
      </ul>
    </section>




    <!-- ***영화정보*** -->
    <section id="film" class="flex absolute align-items-center justify-content-center">
      <h2 class="none">film-info</h2>
    </section>




    <!-- ***메뉴토글*** -->
    <script src="./js/menu.js"></script>
    <div id="menu-bg" class="absolute"></div>




    <!-- ***뮤직플레이어*** -->
    <div id="music-player" class="absolute">
      <div id="album-art" class="hidden relative">
        <img src="img/music/ponyo040.jpg" alt="ponyo">
      </div>
      <div id="music-info" class="flex absolute align-items-center">
        <div id="text">
          <h1>Ponyo on the Cliff by the Sea</h1>
          <p>Fujioka Fujimaki, Ohashi Nozomi</p>
        </div> 
        <div id="play-button"></div>
      </div>
      <div id="play-line"></div>
      <div id="play-control" class="absolute">
        <img src="./img/music/play1.png" alt="play-control">
      </div>
    </div>
  </div>




  <!-- ***슬라이드(이벤트 리스트)*** -->
  <div id="slide" class="relative flex justify-content-center hidden">
    <ul id="slide-ul" class="flex absolute">
      <li class="slide-li flex justify-content-center flex-direction-column">
        <div class="banner flex justify-content-center">
          <img src="./img/event/Ghibli_exhibition.png" alt="banner1">
        </div>
        <div class="slide-text flex align-items-center flex-direction-column">
          <strong class="slide-title block text-align-center">Toshio SUZUKI Ghibli exhibition</strong>
          <span class="place block text-align-center">The Museum of Kyoto(Kyoto Prefecture)</span>
          <p class="date text-align-center">
            2022.04.23(Sat)- 2022.06.19(Sun)
          </p>
          <p class="explain text-align-center">
            Takahata Isao ・ Miyazaki and the Kata-mai (literally, " both have sent a bunch of animated film out in the world along with Studio Ghibli and producers Toshio Suzuki 
            producer) draw attention to an exhibition.
          </p>
        </div>
        <div class="button flex justify-content-center">
          <span class="text-align-center">More</span>
        </div>
      </li>
      <li class="slide-li flex justify-content-center flex-direction-column">
        <div class="banner flex justify-content-center">
          <img src="./img/event/Ghibli_expo.png" alt="banner2">
        </div>
        <div class="slide-text flex align-items-center flex-direction-column">
          <strong class="slide-title block text-align-center">Ghibli The Grand Exposition</strong>
          <span class="place block text-align-center">Iwate Prefectural Museum of Art, access</span>
          <p class="date text-align-center">
            2022.03.23(Sat)- 2022.05.19(Sun)
          </p>
          <p class="explain text-align-center">
            So far, Ghibli -- which eventually go out in the world of the trajectory of the propaganda that are produced by various trials and errors, While He together with an undisclosed data said.Another Tales of the public is clearly and return of his work, Ghibli.
          </p>
        </div>
        <div class="button flex justify-content-center">
          <span class="text-align-center">More</span>
        </div>
      </li>
    </ul>
  </div>
  <!-- 컨트롤(페이저) -->
  <div id="controls" class="flex absolute space-between">
    <div id="prev" class="swapBtn">
      <img src="./img/icon/chevron_left.png" alt="prev">
    </div>
    <div id="pager">
      <div id="cur-pos" class="inline-block">1</div>
      <span>/</span>
      <div id="total-page" class="inline-block">2</div>
    </div>
    <div id="next" class="swapBtn">
      <img src="./img/icon/chevron_right.png" alt="next">
    </div>
  </div>
  <!-- 슬라이드 자바스크립트 -->
  <script>
    let slide = document.querySelector("#slide");
    let slides = document.querySelector("#slide-ul");
    let slideLi = document.querySelectorAll(".slide-li");
    currentIdx = 0;
    slideCount = slideLi.length;
    const prev = document.querySelector("#prev");
    const next = document.querySelector("#next");
    slideWidth = slide.clientWidth;
    slideMargin = 0;

    makeClone();
    initfunction();

    function makeClone(){
      let cloneSlide_first = slideLi[0].cloneNode(true); //slideLi.firstElementChild.cloneNode(true);
      let cloneSlide_last = slides.lastElementChild.cloneNode(true);
      slides.append(cloneSlide_first); 
      slides.insertBefore(cloneSlide_last,slides.firstElementChild);
    }

    function initfunction(){
      slides.style.width = (slideWidth + slideMargin) * (slideCount+2) + "px";
      slides.style.left = -(slideWidth + slideMargin) + "px";
    }

    next.addEventListener('click', function () {
      if (currentIdx <= slideCount-1) {
        slides.style.left = -(currentIdx+2) * (slideWidth+slideMargin) + "px";
        slides.style.transition = `${0.3}s ease-out`;
      }if (currentIdx === slideCount-1){
        setTimeout(function(){
          slides.style.left = -(slideWidth + slideMargin) + "px";
          slides.style.transition = `${0}s ease-out`;
        },500);
        currentIdx = -1;
        } 
        currentIdx+=1;
      }
    );
      // kongukjae code for slide #pager numbering
      const pagerNumber = document.querySelectorAll('#pager div');
      console.log(pagerNumber.length);
      console.log(pagerNumber[0].textContent); // 문자열 1(안의 내용물)이 출력되는것을 확인 할 수 있다. 
      // <div id="pager">
      //  <div id="cur-pos" class="inline-block">1</div>
      //  <span>/</span>
      //  <div id="total-page" class="inline-block">2</div>
      // </div>
      //  **************************************************************
      // #pager의 자식요소는 총 세개이다. / 그 중 div 태그는 두개이다.
      
    

    prev.addEventListener('click', function () {
      // kongukjae code added
      pagerNumber[currentIdx].textContent = currentIdx + 100;
      // currentIdx 핸들러 변수를 '값'으로 쓰는 예시이다.
      // 변수는 조건식의 '기준'으로도 '값'으로도 사용할 수 있다. 

      console.log(currentIdx);
        if (currentIdx >= 0) {
          slides.style.left = -(currentIdx) * (slideWidth + slideMargin) + "px";
          slides.style.transition = `${0.3}s ease-out`;
        }if (currentIdx === 0){
          setTimeout(function(){
            slides.style.left = -(slideCount) * (slideWidth + slideMargin)+ "px";
            slides.style.transition = `${0}s ease-out`;
          },500);
          currentIdx=slideCount;
          } 
          currentIdx-=1;
        }
    );

    
</script>
<!-- 컨트롤 자바스크립트 -->
<script>
  const totalPage = document.querySelector("#total-page");
  console.dir(totalPage);

  totalPage.textContent = slideLi.length;
</script>




  <!-- ***페이드인 - 윈도우 로드***  -->
  <div id="movie-bg" class="absolute"></div>



  <!-- ***라이트(불빛)*** -->\
  <div id="light"></div>




  <!-- ***사이드메뉴 on/off*** -->
  <script>

  const sidemenuUl = document.querySelector('#side-menu ul');
  
  for(let i = 0; i < sidemenuUl.children.length; i++) {
    sidemenuUl.children[i].children[0].style.color = "#F9FFFE";
    sidemenuUl.children[i].children[0].style.transition = ".7s";
    sidemenuUl.children[0].children[0].style.opacity = 1;
    sidemenuUl.children[1].children[0].style.opacity = .6;
    sidemenuUl.children[0].children[0].style.textDecoration = "underline";
    sidemenuUl.children[1].children[0].style.textDecoration = "";
  }

  // 클릭이벤트
  sidemenuUl.addEventListener('click', function(event) {
    console.log(event.target);
    console.log(event.target.parentElement.dataset.index);
    console.log(typeof event.target.parentElement.dataset.index);
    let getIndexValue = Number(event.target.parentElement.dataset.index);
    console.log(typeof getIndexValue);
    

    console.log("반복문으로 활용할 인덱스 값을 마크업 속성노드에서 추출 :" + getIndexValue);
    for(let i = 0; i < sidemenuUl.children.length; i++) {
      if(getIndexValue !== i) {
          console.log(i);
          console.log("제외된 추출값 :" + getIndexValue);
          sidemenuUl.children[i].children[0].style.opacity = 0.6;
          sidemenuUl.children[i].children[0].style.color = "#F9FFFE";
          sidemenuUl.children[i].children[0].style.textDecoration = "none";
        } else {
          sidemenuUl.children[i].children[0].style.opacity = 1;
          sidemenuUl.children[i].children[0].style.color = "#F9FFFE";
          sidemenuUl.children[i].children[0].style.textDecoration = "underline";
        }
      }
  });
  </script>




<!-- ***사이드메뉴 closed 누르면 '1. 종료된 행사 보이기', '2. 페이저 숨기기', '3. 랜턴 깜박', '4. 손전등'*** -->
  <script>
    // const film = document.querySelector("#film");
    const sidemenuLi = document.querySelectorAll("#side-menu-ul li");
    const controls = document.querySelector("#controls");
    const lantern = document.querySelector("#lantern");
    const light = document.querySelector('#light');

    // info on
    sidemenuLi[1].onclick = function(e) {
      light.style.opacity = 1;
      light.style.zIndex = 10;
      light.style.transition = .4 +"s";
      lantern.style.zIndex = 0;
      lantern.style.opacity = 0;
      controls.style.opacity = .3;
    }

    // info off
    sidemenuLi[0].onclick = function(e) {
      light.style.opacity = 0;
      light.style.zIndex = 0;
      light.style.transition = 3 +"s";
      lantern.style.zIndex = 2;
      controls.style.opacity = 1;
      const blink0 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 530);
      const blink1 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 730);
      const blink2 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 830);
      const blink3 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 930);
      const blink4 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 1130);
      const blink5 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 1230);
      const blink6 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 1700);
      clearTimeout(blink0, blink1, blink2, blink3, blink4, blink5, blink6);
      
    }
  </script>




  <!-- ***진입시 페이드효과, 랜턴 깜빡*** -->
  <script>
    const movieBg = document.querySelector("#movie-bg");

    movieBg.style.opacity = 1;

    // 페이드인
    const secondTime = setInterval(function(){
      if (movieBg.style.opacity == 1) {
        movieBg.style.opacity = 0;
        movieBg.style.transition = 1 + "s";
      } else {
        clearInterval(secondTime);
      }
    }, 500);

    // movieBG의 z-index 낮추기
    const zIndex0 = setTimeout(function(){
      movieBg.style.zIndex = 0;
      clearTimeout(zIndex0);
    }, 1200);

    // 랜턴 깜빡
      const blink1 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 1516);
      const blink2 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 1716);
      const blink3 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 1816);
      const blink4 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 1916);
      const blink5 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 2016);
      const blink6 = setTimeout(function(){
        lantern.style.opacity = 0;
      }, 2116);
      const blink7 = setTimeout(function(){
        lantern.style.opacity = 1;
      }, 2616);

    
  </script>


  <script>
    var pos = document.documentElement;
    pos.addEventListener('mousemove', e =>{
      pos.style.setProperty('--x', e.clientX + 'px')
      pos.style.setProperty('--y', e.clientY + 'px')
    });
  </script>
</body>
</html>